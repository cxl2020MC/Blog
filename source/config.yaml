# https://clientworker.js.org/
name: ClientWorker 
cleaninterval: 1000*30 # 每30秒检测并清理一次缓存
# ClientWorker热补丁
hotpatch:
  - https://jsd.cxl2020mc.top/npm/clientworker
  - https://raw.githubusercontent.com/ChenYFan/ClientWorker/gh-pages/cw.js
  - https://cdn.jsdelivr.net/gh/ChenYFan/ClientWorker/cw.js
# Config热更新
hotconfig:
  - https://github.com/cxl2020MC/cxl2020MC.github.io/raw/master/source/config.yaml
  - https://raw.githubusercontent.com/cxl2020MC/cxl2020MC.github.io/master/source/config.yaml
catch_rules:
  # npm加速
  - rule: ^https\:\/\/((cdn|fastly|gcore|test1|quantil)\.jsdelivr\.net\/npm|unpkg\.com|jsd\.cxl2020mc\.top\/npm)
    transform_rules:
      - search: _
        replace:
          - https://jsd.cxl2020mc.top/npm
          - https://vercel.jsd.cxl2020mc.top/npm
          - https://unpkg.cnortles.top
          - https://jsdelivr.pai233.top/npm
          - https://cdn.jsdelivr.net/npm
          - https://unpkg.com
          # - https://repo.huaweicloud.com/repository/npm/
          - _
        action: fetch
        fetch:
          status: 200
          engine: parallel
          preflight: false # false
          timeout: 30000
          cache:
            expire: 1000*60*60*8 # 缓存8小时
            delay: 300
  # github加速
  - rule: ^https\:\/\/((cdn|fastly|gcore|test1|quantil)\.jsdelivr\.net\/gh|jsd\.cxl2020mc\.top\/gh)
    transform_rules:
      - search: _
        replace:
          - https://jsd.cxl2020mc.top/gh
          - https://vercel.jsd.cxl2020mc.top/gh
          - https://cdn.cnortles.top/gh
          - https://jsdelivr.pai233.top/gh
          - https://cdn.jsdelivr.net/gh
          - _
        action: fetch
        fetch:
          status: 200
          engine: parallel
          preflight: false # false
          timeout: 30000
          cache:
            expire: 1000*60*60*8 # 缓存8小时
            delay: 300
  # gravatar头像加速
  - rule: ^https\:\/\/(.*\.gravatar\.com|gravatar\.cxl2020mc\.top|cravatar\.cn)
    transform_rules:
      - search: _
        replace:
          # - https://dn-qiniu-avatar.qbox.me
          - https://gravatar.cxl2020mc.top
          - https://avatar.sourcegcdn.com
          - https://gravatar.loli.net
          - https://www.gravatar.com
          - https://cn.gravatar.com
          - https://sdn.geekzu.org
          - https://cravatar.cn
          - _
        action: fetch
        fetch:
          status: 200
          engine: parallel
          preflight: false # false
          timeout: 30000
          cache:
            expire: 1000*60*60*8 # 缓存8小时
            delay: 300
  - rule: ^https\:\/\/cxl2020mc-1304820025\.file\.myqcloud\.com
    transform_rules:
      - search: _
        action: fetch
        fetch:
          engine: fetch
          preflight: false
          timeout: 50000
          cache:
            expire: 1000*5 # 缓存5分钟
            delay: 300
  # 不劫持（丢给浏览器）
  - rule: .*
    transform_rules:
      - search: _
        action: skip #? 2.8.1新增，跳过cw规则(不能用有bug)
